---
title: "MEPS_reproduce_2"
author: "Andrew Edwards"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{MEPS_reproduce_2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 5.7,
  fig.height = 7
  )

```{r setup}
library(sizeSpectra)
```

## Reproducing simulation results of MEPS paper (Figures 4 and 5 and Table S.3)

The simulated data over an hour (on a fast laptop) to generate, bin and fit.
So results are saved within the package
in the list `MLEbin.MEPS.default`. This list contains the fitted maximum likelihood
value (and confidence interval) of $b$ for each combination of 10,000 simulated
data sets, four binning methods and two fitting methods (MLEmid or MLEbin).

To create `MLEbin.MEPS.default` run the next line (which is not evaluated by
this vignette but is run once in `data-raw/simulate-data2.R` to save
the list as part of this package):
```{r, eval=FALSE}
MLEbin.MEPS.default <- MLEbin.simulate()
```

The list contains three items (see `?MLEbin.simulate`):
```{r}
summary(MLEbin.MEPS.default)
```

Figure 4 shows histograms of the estimates of $b$ for the MLEs for both methods and all four binning types:
```{r}
MLEmid.MLEbin.hist(MLEbin.MEPS.default)
```

Figure 5 gives the confidence intervals for the MLEs for both methods and all four binning types:
```{r}
# These two lines just give a different inset for panel (e):
insetMat = matrix(rep(c(-0.01, -0.04), 4),
                  ncol=2,
                  byrow=TRUE)
insetMat[3, 1] = 0.3

MLEmid.MLEbin.conf(MLEbin.MEPS.default,
                   insetMat = insetMat)
```

Make a dataframe of the results and show here, reproducing Table S.3:
```{r, echo=TRUE, results='asis'}
knitr::kable(MLEmid.MLEbin.table(MLEbin.MEPS.default))
```
